---
import SectionTitle from "../assets/SectionTitle.astro";
import { getCollection } from "astro:content";

const posts = await getCollection('projects', ({ data }) => {
const categories = Array.isArray(data.category)
? data.category.map(c => c.toLowerCase())
: [data.category.toLowerCase()];
return categories.includes('project') || categories.includes('projects');
});
const limitedEntries = posts.slice(0, 2);
---

<section class="border-b border-black/20 divide-y divide-black/20">
  <SectionTitle>
    Projects
  </SectionTitle>
  <div class="p-8">
    <p class="text-black/80 font-black uppercase lg:text-xl">
      End-to-end data systems built for scale; <em>from real-time pipelines to ML-powered applications.</em>
    </p>
  </div>

  <!-- Project cards in horizontal row -->
  <div class="grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-black/20">
    {limitedEntries.map((post) => (
    <a href={`/projects/${post.id}/`} class="p-8 hover:bg-white/5 transition-colors">
      <!-- Category label -->
      <p class="text-cyan text-sm font-mono mb-3 underline underline-offset-4">
        Data Engineering
      </p>

      <!-- Title -->
      <h4 class="font-black text-black uppercase text-sm lg:text-base mb-4 leading-tight">
        {post.data.title}
      </h4>

      <!-- Description -->
      <p class="text-black/70 text-sm leading-relaxed">
        {post.data.description}
      </p>
    </a>
    ))}
  </div>
</section>
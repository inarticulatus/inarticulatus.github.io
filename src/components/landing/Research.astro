---
import BgGrid from "../assets/BgGrid.astro";
import SectionTitle from "../assets/SectionTitle.astro";
import { getCollection } from "astro:content";

const posts = await getCollection('projects', ({ data }) => {
return data.category == 'research'
});
const limitedEntries = posts.slice(0, 3);
---

<section class="border-black/20 border-b divide-y divide-black/20">
  <SectionTitle>
    Research & Insight
  </SectionTitle>
  <div class="p-8">
    <p class="text-black/80 font-black uppercase lg:text-xl">
      Deep dives into algorithms, statistics, and ML theory; <em>implemented from first principles.</em>
    </p>
  </div>

  <!-- Research cards in horizontal row -->
  <div class="grid grid-cols-1 md:grid-cols-3 divide-y md:divide-y-0 md:divide-x divide-black/20">
    {limitedEntries.map((post) => (
    <a href={`/projects/${post.id}/`} class="p-8 hover:bg-white/5 transition-colors">
      <!-- Category label -->
      <p class="text-cyan text-sm font-mono mb-3 underline underline-offset-4">
        {post.data.category === 'research' ? 'Mathematical Foundations' : post.data.category}
      </p>

      <!-- Title -->
      <h4 class="font-black text-black uppercase text-sm lg:text-base mb-4 leading-tight">
        {post.data.title}
      </h4>

      <!-- Description -->
      <p class="text-black/70 text-sm leading-relaxed">
        {post.data.description}
      </p>
    </a>
    ))}
  </div>
</section>